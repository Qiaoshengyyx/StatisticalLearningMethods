---
permalink: /_posts/chapter3.html
title: chapter3
layout: post
---
# k近邻法

## 简介
k近邻法根据新实例的k个最近邻的训练实例的类别，通过多数表决等方式进行预测，是一种基本的分类与回归方法。

k近邻法**三要素**：k值的选择、距离度量、分类决策规则。



## kd树
kd树是二叉树，表示对k维空间的一个划分，用于提高k近邻搜索的效率，减少计算距离的次数。构造kd树相当于不断地用垂直于坐标轴的超平面将k维空间切分，构成一系列的k维超矩形区域，每个结点对应与一个k维超矩形区域。

## 习题
**3.1**
[knn代码](chapter3.py)

**3.2**
根据算法3.3流程，
(1) 先找到包含目标点的叶结点。 根据$x^{(1)}$坐标，3<7，找到下一个子矩形根结点$(5,4)^{\mathrm T}$，根据$x^{(2)}$坐标，4.5>4，到达叶结点$(4,7)^{\mathrm T}$。

(2) 将叶结点$(4,7)^{\mathrm T}$作为最邻近点，计算得到目标点与叶结点欧氏距离为$\sqrt{7.25}$。

(3) 向上回退回退到父结点$(5,4)^{\mathrm T}$。
&#8195;&#8195;(a)该父结点与目标点欧氏距离为$\sqrt{4.25}$，小于$\sqrt{7.25}$，因此将其作为当前最邻近点。
&#8195;&#8195;(b) 以目标点为圆心，以目标点与当前最邻近点点距离为半径圆（二维是圆），半径为$\sqrt{4.25}$，发现点$(2,3)^{\mathrm T}$在圆内，它与目标点的距离为$\sqrt{3.25}$。说明可能在该子结点对应点区域内存在距离目标点更近的点，移动到点$(2,3)^{\mathrm T}$。
&#8195;&#8195;回退到$(5,4)^{\mathrm T}$的父结点$(7,2)^{\mathrm T}$，目标点与该结点的距离为$\sqrt{22.25}$，大于$\sqrt{3.25}$，向上回退。
(4) 由于已经到达根结点即$(7,2)^{\mathrm T}$，搜索结束，点$x=(3,4.5)^{\mathrm T}$的最近邻点为$(2,3)^{\mathrm T}$。

**3.3**
[kd树代码](chapter3.py)

## 尚未解决的问题
1. kd树搜索的递归函数中，遇到传参问题，递归无法返回目标结果，结果中距离是正确的但是最近邻点是错误的，本来在递归函数中有一个存放最短距离的参数min_dis和一个存放最近邻点向量的参数now_closest，但是now_closest在函数结束后总是和赋予的初值一样，而将min_dis作为存放 最短距离、最近邻点向量列表 的参数就可以实现目标。